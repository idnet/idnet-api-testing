<script type="text/javascript">
var site = '%%site%%';
$(document).ready(function() {
	var token = getHashParams().access_token;
	
	function api(url, data, method){
		var options = {
			type: method,
			url: site+url,
			headers: {'Authorization': 'Bearer ' + token},
			data: data,
			success: function(data, textStatus, jqXHR){display(jqXHR.responseText);},
			error: function( jqXHR, textStatus, errorThrown ){display(errorThrown+'<br>'+jqXHR.responseText);}
		};
		$.ajax(options);
		console.log(site+url+'?access_token='+token);
	}
	function getHashParams() {
		var hashParams = {};
		var e,
			a = /\+/g,  // Regex for replacing addition symbol with a space
			r = /([^&;=]+)=?([^&;]*)/g,
			d = function (s) { return decodeURIComponent(s.replace(a, " ")); },
			q = window.location.hash.substring(1);

		while (e = r.exec(q))
			hashParams[d(e[1])] = d(e[2]);

			return hashParams;
	}
	function display(data){
		$('#status').html(data);
	}
	
	$('#profile1').click(function(e){
		api('api/v1/json/profile', null, 'GET');
	});
	$('#profile2').click(function(e){
		api('api/profile', null, 'GET');
	});
	$('#friends-simple').click(function(e){
		api('api/v1/json/'+$('#pid').val()+'/friends', null, 'GET');
	});
	$('#friends-all').click(function(e){
		api('api/v1/json/'+$('#pid').val()+'/friends-all', null, 'GET');
	});
	$('#friends').click(function(e){
		api('api/v1/json/links/friends', null, 'GET');
	});
	$('#follow').click(function(e){
		console.log($('#targetpid').val());
		api('api/v1/json/links/follow/'+$('#targetpid').val(), null, 'POST');
	});
});
</script>
<div id="status" style="max-height:300px;"></div>
<div id="profile1" class="link">Profile1</div>
<div id="profile2" class="link">Profile2</div>
<div id="friends-simple" class="link">Friends Simple</div>
<div id="friends-all" class="link">Friends All</div>
<div id="friends" class="link">Friends</div>
<div id="follow" class="link">Follow</div>
<br>
Your pid for friend apis<br>
<input id="pid" value="Your pid" style="width:200px;"><br>
Target pid for friend api actions<br>
<input id="targetpid" value="target pid" style="width:200px;">